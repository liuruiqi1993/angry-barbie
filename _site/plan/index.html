<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>学习计划 | 立个flag先</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="学习计划" />
<meta name="author" content="刘瑞琪" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="每天进步一.." />
<meta property="og:description" content="每天进步一.." />
<link rel="canonical" href="http://localhost:4000/plan/" />
<meta property="og:url" content="http://localhost:4000/plan/" />
<meta property="og:site_name" content="立个flag先" />
<script type="application/ld+json">
{"headline":"学习计划","author":{"@type":"Person","name":"刘瑞琪"},"description":"每天进步一..","@type":"WebPage","url":"http://localhost:4000/plan/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="立个flag先" />
</head>
<body><header class="site-header sticky-top">
  <nav class="navbar navbar-expand-sm navbar-light wrapper">
    <a class="navbar-brand site-title" rel="author" href="/">立个flag先</a>

    <div class="social social1"><ul class="social-media-list"><li><a rel="me" target="_blank"
      href="mailto:405782134@qq.com"
      title="405782134@qq.com"><svg class="svg-icon">
        <use xlink:href="/assets/font/minima-social-icons.svg#email"></use>
      </svg></a></li><li><a rel="me" target="_blank" href="https://github.com/liuruiqi1993" title="liuruiqi1993"><svg class="svg-icon"><use xlink:href="/assets/font/minima-social-icons.svg#github"></use></svg></a></li></ul></div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>


    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="navbar-nav site-nav navbar-light"><li class="nav-item">
          <a class="nav-link page-link" href="/plan/index.html">学习计划</a>
        </li></ul>
    </div>

    <div class="social social2"><ul class="social-media-list"><li><a rel="me" target="_blank"
      href="mailto:405782134@qq.com"
      title="405782134@qq.com"><svg class="svg-icon">
        <use xlink:href="/assets/font/minima-social-icons.svg#email"></use>
      </svg></a></li><li><a rel="me" target="_blank" href="https://github.com/liuruiqi1993" title="liuruiqi1993"><svg class="svg-icon"><use xlink:href="/assets/font/minima-social-icons.svg#github"></use></svg></a></li></ul></div>
  </nav>
</header>
<main class="page-content" aria-label="Content"  data-spy="scroll" data-target="#toc" data-offset="20">
      <div class="custom-nav side-sticky sticky-top"><nav class="collection-wrap" id="accordionExample">
    
    <div class="collection-item">
        <a class="collection-head" href="/css/list" data-toggle="collapse" data-target="#Css" aria-expanded="false"
            aria-controls="Css">
            Css
        </a>
        <ul id="Css" class="collection-body collapse" aria-labelledby="Css" data-parent="#accordionExample"><li>
                <a href="/css/%20adaptive/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94.html">
                    响应式和自适应
                </a>
            </li><li>
                <a href="/css/3D-animate/3D%E4%B8%8E%E5%8A%A8%E7%94%BB.html">
                    3d与动画
                </a>
            </li><li>
                <a href="/css/CSS%E9%80%89%E6%8B%A9%E5%99%A8.html">
                    CSS选择器
                </a>
            </li><li>
                <a href="/css/Less-Sass.html">
                    less and sass
                </a>
            </li><li>
                <a href="/css/font/CSS%E5%AD%97%E4%BD%93.html">
                    CSS字体
                </a>
            </li><li>
                <a href="/css/property/CSS%E5%B1%9E%E6%80%A7.html">
                    CSS属性
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/html/list" data-toggle="collapse" data-target="#HTML" aria-expanded="false"
            aria-controls="HTML">
            HTML
        </a>
        <ul id="HTML" class="collection-body collapse" aria-labelledby="HTML" data-parent="#accordionExample"><li>
                <a href="/html/meta/meta.html">
                    meta
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/http/list" data-toggle="collapse" data-target="#HTTP" aria-expanded="false"
            aria-controls="HTTP">
            HTTP
        </a>
        <ul id="HTTP" class="collection-body collapse" aria-labelledby="HTTP" data-parent="#accordionExample"><li>
                <a href="/http/%E7%8A%B6%E6%80%81%E7%A0%81.html">
                    请求
                </a>
            </li><li>
                <a href="/http/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86.html">
                    反向代理
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/js/list" data-toggle="collapse" data-target="#JavaScript" aria-expanded="false"
            aria-controls="JavaScript">
            JavaScript
        </a>
        <ul id="JavaScript" class="collection-body collapse" aria-labelledby="JavaScript" data-parent="#accordionExample"><li>
                <a href="/js/Array%E6%80%BB%E7%BB%93.html">
                    Array总结
                </a>
            </li><li>
                <a href="/js/Function%E6%80%BB%E7%BB%93.html">
                    Function总结
                </a>
            </li><li>
                <a href="/js/Map,Set%E5%92%8Citerable.html">
                    Map，Set和iterable
                </a>
            </li><li>
                <a href="/js/%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%AE%A1%E5%88%92%E8%A1%A8.html">
                    创建一个计划表：增删改查拖拽
                </a>
            </li><li>
                <a href="/js/input%E4%BA%8B%E4%BB%B6%E9%A1%BA%E5%BA%8F.html">
                    input如何处理中文输入，事件顺序
                </a>
            </li><li>
                <a href="/js/Object%E6%80%BB%E7%BB%93.html">
                    Object总结
                </a>
            </li><li>
                <a href="/js/String%E6%80%BB%E7%BB%93.html">
                    String总结
                </a>
            </li><li>
                <a href="/js/async,%20await,%20generator.html">
                    async, await, generator
                </a>
            </li><li>
                <a href="/js/copy/%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D.html">
                    深浅拷贝
                </a>
            </li><li>
                <a href="/js/wenjiangeshi.html">
                    MIME, Base64, Blob
                </a>
            </li><li>
                <a href="/js/%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E5%92%8C%E7%AE%80%E5%86%99%E9%97%AE%E9%A2%98.html">
                    概念和简写
                </a>
            </li><li>
                <a href="/js/%E7%BB%A7%E6%89%BF/yuanxing.html">
                    原型和继承
                </a>
            </li><li>
                <a href="/js/Number.html">
                    Number总结
                </a>
            </li><li>
                <a href="/js/window/window.html">
                    Window
                </a>
            </li><li>
                <a href="/js/%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD.html">
                    异步加载和Promise
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/react/list" data-toggle="collapse" data-target="#React" aria-expanded="false"
            aria-controls="React">
            React
        </a>
        <ul id="React" class="collection-body collapse" aria-labelledby="React" data-parent="#accordionExample"><li>
                <a href="/react/react.html">
                    React笔记
                </a>
            </li><li>
                <a href="/react/%E5%B0%9D%E8%AF%95%E4%B8%80%E4%B8%AAreact.html">
                    尝试一个react
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/record/list" data-toggle="collapse" data-target="#记录" aria-expanded="false"
            aria-controls="记录">
            记录
        </a>
        <ul id="记录" class="collection-body collapse" aria-labelledby="记录" data-parent="#accordionExample"><li>
                <a href="/record/jekyll/jekyll.html">
                    Jekyll笔记
                </a>
            </li><li>
                <a href="/record/Mayday%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html">
                    Mayday阶段总结
                </a>
            </li><li>
                <a href="/record/mock.html">
                    Mock
                </a>
            </li><li>
                <a href="/record/%E7%AB%8B%E4%B8%AAflag.html">
                    立个flag
                </a>
            </li><li>
                <a href="/record/git%E5%92%8Clinux%E5%91%BD%E4%BB%A4.html">
                    git和linux命令
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/ts/list" data-toggle="collapse" data-target="#TypeScript" aria-expanded="false"
            aria-controls="TypeScript">
            TypeScript
        </a>
        <ul id="TypeScript" class="collection-body collapse" aria-labelledby="TypeScript" data-parent="#accordionExample"><li>
                <a href="/ts/typescript.html">
                    TypeScript笔记
                </a>
            </li></ul>
    </div>
    <div class="collection-item">
        <a class="collection-head" href="/vue/list" data-toggle="collapse" data-target="#Vue" aria-expanded="false"
            aria-controls="Vue">
            Vue
        </a>
        <ul id="Vue" class="collection-body collapse" aria-labelledby="Vue" data-parent="#accordionExample"><li>
                <a href="/vue/vue.html">
                    Vue笔记
                </a>
            </li><li>
                <a href="/vue/%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A.html">
                    双向绑定Object.defineProperty和Proxy
                </a>
            </li><li>
                <a href="/vue/%E9%80%9A%E4%BF%A1.html">
                    通信
                </a>
            </li></ul>
    </div></nav></div>
      <div class="sidebar side-sticky sticky-top"><script src="/assets/js/toc.js"></script>
<div id="toc"> 
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $('#toc').toc();
    });
</script></div>
      <div class="wrapper">
        <article class="plan">
    <header class="post-header">
        <h1 class="post-title">学习计划</h1>
    </header>

    <div class="post-content">
        <form class="needs-validation" novalidate>
            <div class="row">
                <div class="mb col-xs-12 col-sm-7 col-md-8 col-lg-8 col-xl-8">
                    <div class="form-row row-2">
                        <div class="col">
                            <input  type="text" id="name" class="form-control" placeholder="名称">
                            <div class="invalid-feedback">
                                <span>新增项名字不能为空</span>
                                <span>筛选条件不能为空</span>
                            </div>
                        </div>
                        <div class="col">
                            <select class="custom-select" id="status">
                                <option value=''>全部状态</option>
                                <option value="1">已完成</option>
                                <option value="0">未完成</option>
                            </select>
                            <div class="invalid-feedback">
                                <span>筛选条件不能为空</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mb col-xs-12 col-sm-5 col-md-4 col-lg-4 col-xl-4">
                    <div class="btn-group" role="group">
                        <button type="button" id="add" class="btn btn-success">新增</button>
                        <button type="button" id="filter" class="btn btn-warning">过滤</button>
                        <button type="button" id="reset" class="btn btn-primary">条件重置</button>
                    </div>
                </div>
            </div>
        </form>
        <div class="card mb">
            <div class="card-body">
                <h5 class="title justify-content-between">未完成 <span class="badge badge-primary badge-pill">14</span></h5>
                <ul class="list-group todo">
                </ul>
            </div>
        </div>
        <div class="card mb">
            <div class="card-body">
                <h5>已完成</h5>
                <ul class="list-group done">
                </ul>
            </div>
        </div>
    </div>
    <style>
        .mb{
            margin-bottom: 10px;
        }
        .list-group{
            margin-left: 0;
        }
        .card .title{
            display: flex;
        }
        .card .form-group{
            margin-bottom: 0;
        }
        .form-control-plaintext{
            resize: none;
            padding: 0;
            height: 28px !important;
        }
        .btn-group button{
            white-space: nowrap;;
        }
    </style>
    <script>
        $(($) => {
            // 公共方法
            const setClock = (a) => {
                return !a ? new Date() : null
            }
            const getClock = (a) => {
                a = new Date(a)
                return `${a.getFullYear()}-${format(a.getMonth() + 1)}-${format(a.getDay())} ${format(a.getHours())}:${format(a.getMinutes())}:${format(a.getSeconds())}`
            }
            const getStorage = (key) => {
                return JSON.parse(localStorage.getItem("list") || '[]')
            }
            const setStorage = () => {
                localStorage.setItem("list", JSON.stringify(list))
                load()
            }
            const format = (a)=> {
                return a >= 10 ? a : '0'+a
            }

            //公共变量
            let list = null;
            let dragIndex = 0
            let _plan = $('.plan');
            let _form = $('.needs-validation');
            let _name = $('#name')
            let _status = $('#status')
            let _todo = $('.todo')
            let _done = $('.done')
            let _badge = $('.badge')
            let message = _name.next().children()

            //方法
            const load = () => {
                let name = _name.val()
                let status = _status.val()
                list = getStorage("list")
                let done = []
                let todoStr = ""
                let doneStr = ""
                let pending = 0;
                list.map((item,index) => {
                    if(item.status){
                        if (!((name && item.name.indexOf(name) === -1)
                            || (status && item.status != status))) {
                                //已完成
                                item.index = index
                                if (!done.some((doneItem, doneIndex) => {
                                    if (doneItem.finished_time > item.finished_time) {
                                        done.splice(doneIndex, 0, item)
                                        return doneItem.finished_time > item.finished_time
                                    }
                                })) {
                                    done.push(item)
                                };
                            }
                    } else {
                        if (!((name && item.name.indexOf(name) === -1 )
                        || (status && item.status != status))){
                            //未完成
                            todoStr += `<li class="list-group-item d-flex justify-content-between align-items-center list-group-item-action" data-index="${index}" data-order="${pending}" draggable="true">
                                <div class="form-group form-check container-fluid">
                                    <span class="post-meta">${getClock(item.created_time)}</span>
                                    <br/>
                                    <input type="checkbox" class="form-check-input">
                                    <textarea class="form-control-plaintext" row="1" readonly>${item.name}</textarea>
                                </div>
                                <button type="button" class="close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </li>`
                            pending++
                        }
                    }
                })  
                done.reverse().map((item) => {
                    doneStr += `<li class="list-group-item d-flex justify-content-between align-items-center list-group-item-action" data-index="${item.index}">
                        <div class="form-group form-check">
                            <span class="post-meta">${getClock(item.finished_time)}</span><br/>
                            <input type="checkbox" class="form-check-input" checked>${item.name}
                        </div>
                        <button type="button" class="close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </li>`
                })
                _badge.html(pending)
                _todo.html(todoStr)
                _done.html(doneStr)
            }
            const validate=(key)=>{
                switch(key){
                    case 'add': return !_name.val()
                    case 'filter':  return !_name.val() && !_status.val();
                }
            };
            const add=()=>{
                _status.removeClass("is-invalid")
                if (validate('add')) {
                    //未通过给提示
                    message.first().show();
                    message.last().hide();
                    _name.addClass("is-invalid")
                } 
                else {
                    //通过验证新增
                    list.push({
                        name: _name.val(),
                        status: 0,
                        created_time: setClock()
                    })
                    _name.val("")
                    setStorage()
                }
            }
            const remove=(a)=>{
                list.splice(a, 1)
                setStorage()
            }
            const update=(key, value, index)=>{
                list[index][key] = value
                setStorage()
            }
            const filter=()=>{
                if (validate('filter')){
                    message.first().hide();
                    message.last().show();
                    _name.addClass("is-invalid")
                    _status.addClass("is-invalid")
                }
                else{
                    load()
                }
            }
            const reset=()=>{
                _name.val("")
                _status.val("")
                message.first().hide();
                message.last().hide();
                _name.removeClass("is-invalid")
                _status.removeClass("is-invalid")
                load()
            }

            //调用
            load()
            $('#add').on("click", add)
            $('#filter').on("click", filter)
            $('#reset').on("click", reset)
            _name.on("blur", () => {
                _name.removeClass("is-invalid")
            })
            _status.on("blur", () => {
                _status.removeClass("is-invalid")
            })
            _plan.on("click", '.close', (e) => {
                let {index} = e.currentTarget.parentNode.dataset
                remove(index)
            })
            _plan.on("click", '.form-check-input', (e) => {
                let checked = e.currentTarget.checked ? 1 : 0
                let { index } = e.currentTarget.parentNode.parentNode.dataset
                update('status', checked, index)
                update('finished_time', checked ? setClock() : null, index)
            })
            _plan.on("dblclick", 'textarea', (e) => {
                $(e.currentTarget).removeAttr('readonly')
            })
            _plan.on("blur", 'textarea', (e) => {
                if(!e.currentTarget.readOnly){
                    let value = e.currentTarget.value
                    let { index } = e.currentTarget.parentNode.parentNode.dataset
                    if (value) {update('name', value, index)} 
                    else {remove(index)}
                    $(e.currentTarget).attr('readonly')
                }
            })
            _plan.on("dragend", 'li', (e) => {
                let index = e.currentTarget.dataset.index
                if(dragIndex != index){
                    list.splice(dragIndex, 0, list.splice(index, 1)[0])
                }
                setStorage()
                load()
                e.preventDefault()
            })
            _todo.on("dragover", "li", (e) => {
                dragIndex = e.currentTarget.dataset.index;
                e.preventDefault()
            })
        });
    </script>
</article>
      </div>
    </main>

    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">刘瑞琪</li>
          <li><a class="u-email" href="mailto:405782134@qq.com">405782134@qq.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>每天进步一..
</p>
      </div>
    </div>
  </div>

</footer>
-->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>

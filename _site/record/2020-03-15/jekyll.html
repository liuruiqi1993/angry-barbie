<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Jekyll | 立个flag先</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Jekyll" />
<meta name="author" content="刘瑞琪" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="记录用jekyll建博中遇到的麻烦，主要是墙 系统: mac Mojave 参考: （中文文档）http://jekyllcn.com/ （英文文档）https://jekyllrb.com （参考三）https://alligator.io/jekyll/ （参考四：从无到有全过程，这不是我的重点）https://blog.csdn.net/qq_19799765/article/details/80869363和https://zhuanlan.zhihu.com/p/28321740" />
<meta property="og:description" content="记录用jekyll建博中遇到的麻烦，主要是墙 系统: mac Mojave 参考: （中文文档）http://jekyllcn.com/ （英文文档）https://jekyllrb.com （参考三）https://alligator.io/jekyll/ （参考四：从无到有全过程，这不是我的重点）https://blog.csdn.net/qq_19799765/article/details/80869363和https://zhuanlan.zhihu.com/p/28321740" />
<link rel="canonical" href="http://localhost:4000/record/2020-03-15/jekyll.html" />
<meta property="og:url" content="http://localhost:4000/record/2020-03-15/jekyll.html" />
<meta property="og:site_name" content="立个flag先" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-15T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"Jekyll","dateModified":"2020-03-15T00:00:00+08:00","datePublished":"2020-03-15T00:00:00+08:00","author":{"@type":"Person","name":"刘瑞琪"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/record/2020-03-15/jekyll.html"},"description":"记录用jekyll建博中遇到的麻烦，主要是墙 系统: mac Mojave 参考: （中文文档）http://jekyllcn.com/ （英文文档）https://jekyllrb.com （参考三）https://alligator.io/jekyll/ （参考四：从无到有全过程，这不是我的重点）https://blog.csdn.net/qq_19799765/article/details/80869363和https://zhuanlan.zhihu.com/p/28321740","@type":"BlogPosting","url":"http://localhost:4000/record/2020-03-15/jekyll.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="立个flag先" />
</head>
<body><header class="site-header">
  <nav class="navbar navbar-expand-sm navbar-light wrapper">
    <a class="navbar-brand site-title" rel="author" href="/">立个flag先</a>

    <div class="social social1"><ul class="social-media-list"><li><a rel="me" target="_blank"
      href="mailto:405782134@qq.com"
      title="405782134@qq.com"><svg class="svg-icon">
        <use xlink:href="/assets/minima-social-icons.svg#email"></use>
      </svg></a></li><li><a rel="me" target="_blank" href="https://github.com/liuruiqi1993" title="liuruiqi1993"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul></div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>


    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="navbar-nav site-nav navbar-light"><li class="nav-item">
          <a class="nav-link page-link" href="/plan/">学习计划</a>
        </li></ul>
    </div>

    <div class="social social2"><ul class="social-media-list"><li><a rel="me" target="_blank"
      href="mailto:405782134@qq.com"
      title="405782134@qq.com"><svg class="svg-icon">
        <use xlink:href="/assets/minima-social-icons.svg#email"></use>
      </svg></a></li><li><a rel="me" target="_blank" href="https://github.com/liuruiqi1993" title="liuruiqi1993"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul></div>
  </nav>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Jekyll</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-03-15T00:00:00+08:00" itemprop="datePublished">
        Mar 15, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>记录用jekyll建博中遇到的麻烦，主要是墙 <br />
系统: mac Mojave <br />
参考:</p>
<ol>
  <li>（中文文档）<a href="http://jekyllcn.com/">http://jekyllcn.com/</a></li>
  <li>（英文文档）<a href="https://jekyllrb.com">https://jekyllrb.com</a></li>
  <li>（参考三）<a href="https://alligator.io/jekyll/">https://alligator.io/jekyll/</a></li>
  <li>（参考四：从无到有全过程，这不是我的重点）<a href="https://blog.csdn.net/qq_19799765/article/details/80869363">https://blog.csdn.net/qq_19799765/article/details/80869363</a>和<a href="https://zhuanlan.zhihu.com/p/28321740">https://zhuanlan.zhihu.com/p/28321740</a></li>
</ol>

<h2 id="模版">模版</h2>
<p>图省事，从<a href="https://github.com/jekyll/minima">https://github.com/jekyll/minima</a>拷了文件，想照着readme直接<code class="highlighter-rouge">bundle exec jekyll serve</code>运行，结果报错说不认识<code class="highlighter-rouge">bundle</code> 和 <code class="highlighter-rouge">jekyll</code>。</p>

<blockquote>
  <p>You can find and preview themes on different galleries:<br />
<a href="https://jamstackthemes.dev/ssg/jekyll/">jamstackthemes.dev</a><br />
<a href="http://jekyllthemes.org/">jekyllthemes.org</a><br />
<a href="https://jekyllthemes.io/">jekyllthemes.io</a><br />
<a href="https://jekyll-themes.com/">jekyll-themes.com</a></p>
</blockquote>

<h2 id="安装bundle和jekyll">安装bundle和jekyll</h2>
<p>按照jekyll文档<code class="highlighter-rouge">gem install jekyll bundler</code>报错，最后找到原因</p>

<p><strong>一号墓坑: mac Ruby要 &gt; 2.4.0</strong></p>

<blockquote>
  <p>Jekyll requires Ruby &gt; 2.4.0.macOS Catalina 10.15 comes with ruby 2.6.3, so you’re fine. If you’re running a previous macOS system, you’ll have to install a newer version of Ruby.</p>
</blockquote>

<h2 id="安装ruby">安装Ruby</h2>
<p><a href="https://jekyllrb.com/docs/installation/">https://jekyllrb.com/docs/installation/</a>
试了半天才发现MAC教程里的 <em>With Homebrew</em>和<em>With rbenv</em>实际上用的相同的一句，至于是不是教程写错了，咱也不敢问。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
</code></pre></div></div>

<p><strong>二号墓坑：网速是真的慢呀，十几K几K的下，怪你上网的时间不对</strong>。</p>

<p>因为都是<em>With Homebrew</em>所以就照着<em>With Homebrew</em>教程走到黑。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install ruby

echo 'export PATH="/usr/local/opt/ruby/bin:$PATH"' &gt;&gt; ~/.bash_profile

ruby -v
ruby 2.6.3p62 (2019-04-16 revision 67580)

# 如果需要升级gem，见https://gems.ruby-china.com/

gem install jekyll bundler

bundler install

bundle exec jekyll serve
</code></pre></div></div>

<p>这里就可以运行了，后面就都是自定义样式遇到的问题。</p>

<h2 id="建立集合">建立集合</h2>
<p>jekyll默认把md文件放进_post中，通过site.posts去取。如果想分类，中文和英文文档里collection这一部分都一言难尽，请参考<a href="https://alligator.io/jekyll/collections/">https://alligator.io/jekyll/collections/</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_config.yml

collections_dir: collections
collections:
  js:
    output: true
    title: Javasript
  record:
    output: true
    title: 记录
  css:
    output: true
    title: Css
  webpack:
    output: true
    title: Webpack
</code></pre></div></div>
<p>改完<code class="highlighter-rouge">_config.yml</code>重新运行项目。</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 文件结构

_layout
    default.html
    home.html
    list.html
    post.html
collections   (和_config.yml同一层)
    _css      (里面放md或子文件夹，注意名字里的_)
    _js       (里面放md或子文件夹，注意名字里的_)
    _record   (里面放md或子文件夹，注意名字里的_)
    _webpack  (里面放md或子文件夹，注意名字里的_)

</code></pre></div></div>
<p>上两部结束就能<code class="highlighter-rouge">site.js</code>，<code class="highlighter-rouge">site.css</code>，<code class="highlighter-rouge">site.record</code>这样取到数组。</p>

<p><img src="20200316010138.jpg" alt="" /></p>

<p>因为collections下有多个collection，所以我选择遍历<code class="highlighter-rouge">site.collections</code>。语法看<a href="https://shopify.github.io/liquid/">https://shopify.github.io/liquid/</a>。<br />
for 循环里加上<code class="highlighter-rouge">limit:3</code>表示最多展示3个。size是数组长度。</p>

<blockquote>
  <p><code class="highlighter-rouge">if post.menu == undefined</code>与第9行是我私人的判断条件，后面再解释。(起初这样写是因为不能像javascript这样<code class="highlighter-rouge">!post.menu</code>，然而写这篇文章时碰巧发现这一句还能这样写<code class="highlighter-rouge">unless post.menu</code>，见<a href="https://shopify.github.io/liquid/tags/control-flow/">Control flow</a>)</p>
</blockquote>

<p><img src="20200316011222.jpg" alt="" /></p>

<p>我希望实现的效果：<br />
首页中展示collections（即前文_config.yml里定义的[css，js，record，webpack]）<br />
每个collection最多展示2条，加上list.md所以limit是2。<br />
点击collection title，就去列表页，展示collection下的post。<br />
点击post title，就跳去详情页。</p>

<p><img src="20200316013355.jpg" alt="" /></p>

<p>详情页post.html，是拷下来的文件里写好的。<br />
列表页list.html照着home.html改了一下，你以为这样就完了吗？<br />
我在这里遇到了<strong>3号墓坑，路由怎么都不对，<code class="highlighter-rouge">/collectionLabel/list</code>返回404</strong>。</p>

<p><img src="20200316014749.jpg" alt="" /></p>

<p>我是怎么找着原因的呢？因为<code class="highlighter-rouge">/home</code>也是404，那么就可以肯定不是按寻常<code class="highlighter-rouge">/index.html</code>， <code class="highlighter-rouge">/home.html</code>这种思路去读。这就是写list.md的理由，每个collection下都有一个list.md，每个list.md都定义permalink。如此，当路由和permalink吻合时，就能找到对应的collection下的list.md，展示正确的列表页。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_record下的list.md

---
layout: list             &lt;!-- 指套用_layout中的list.html为模版 --&gt;
permalink: /record/list  
title: 记录
type: record
menu: true
---
</code></pre></div></div>
<p>同理每一篇博文post.md需要套用post.html最为模版，menu为假。日期也可以写在文件名上，如：<code class="highlighter-rouge">2011-12-31-new-years-eve-is-awesome.md</code></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
layout: post
date: 2020-03-15
---
</code></pre></div></div>
<p><strong>四号墓坑：_site文件没上传，结果scss样式没有编译，bootStrap的NAV栏切换也不生效，my bad</strong></p>


  </div><a class="u-url" href="/record/2020-03-15/jekyll.html" hidden></a>
</article>

      </div>
    </main>

    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">刘瑞琪</li>
          <li><a class="u-email" href="mailto:405782134@qq.com">405782134@qq.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>每天进步一..
</p>
      </div>
    </div>
  </div>

</footer>
-->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>

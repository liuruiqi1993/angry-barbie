---
description: '参考：https://juejin.cn/post/6844904170894393358'
---

# 浏览器渲染原理

浏览器渲染总体来说分为以下几步

1. 浏览器通过HTTP或者HTTPS协议，先服务端`请求页面`
2. 把请求回来的HTML解析成`DOM树`
3. 把CSS解析成`CSSOM树`
4. 把DOM树和CSSOM树组合在一起，生成`渲染树(RENDER TREE)`
5. 通过渲染树计算出`布局(layout)`
6. 渲染引擎会遍历Render树，`绘制(painting)`到界面上

## 资源加载

浏览器自上而下读取代码，读取到资源文件

### css

使用css有三种方式：使用link、@import、内联样式，其中link和@import都是导入外部样式。它们之间的区别：

* link：浏览器会派发一个新等线程\(HTTP线程\)去加载资源文件，与此同时GUI渲染线程会继续向下渲染代码
* @import：GUI渲染线程会暂时停止渲染，去服务器加载资源文件，资源文件没有返回之前不会继续渲染\(阻碍浏览器渲染\)
* style：GUI直接渲染

另外外部样式如果长时间没有加载完毕，浏览器为了用户体验，会使用浏览器会默认样式，确保首次渲染的速度。所以css一般写在headr中，让浏览器尽快发送请求去获取css样式。

### javascript

JavaScript执行线程与GUI渲染线程不能同时执行，这就意味着执行js代码势必会阻塞页面渲染。为了不阻塞页面的渲染，可以：

* script标签放在页面的尾部，确保dom生成完再加载js
* 尽可能使用defer、async

关于`<script>`、`<script defer>`、`<script async>`的区别\(配合图片食用更佳\)

* `<script>`：立即停止页面渲染去加载资源文件，当资源加载完毕后立即执行js代码，js代码执行完毕后继续渲染页面
* `<script defer>`：开辟新的线程去加载资源文件，当资源加载完毕后等待页面渲染，页面渲染完毕后再执行js代码
* `<script async>`：开辟新的线程去加载资源文件，当资源加载完毕后立即执行js代码，js代码执行完毕后继续渲染页面\(特别注意：多个async js执行顺序是按照加载完毕的顺序，非js请求顺序\)

